@{
    ViewBag.Title = "Said后台 - 分类/标签管理";
    Layout = "~/Areas/Back/Views/Shared/_LayoutBack.cshtml";
}
<div class="page-header">
    <h2>标签/分类&nbsp;&nbsp;<small>&gt;标签/分类管理</small></h2>
</div>
<ol class="breadcrumb">
    <li><a href="javascript:;">Home</a></li>
    <li class="active">标签/分类</li>
</ol>
<div class="main-context">
    <div class="row">
        <div class="col-md-6">
            <div class="bs-table">
                <span class="navbar-left"></span>
                <table id="classifyTable" data-toolbar="" class="table table-hover table-striped" data-striped="true" data-show-refresh="true" data-show-columns="true" data-search="true" data-pagination="true"></table>
            </div>
        </div>
        <div class="col-md-6">
            <div class="bs-table">
                <form class="navbar-form navbar-right table-tool" role="search" id="tagsToolbar">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="添加一个新的标签" />
                    </div>
                    <button type="submit" class="btn btn-info ">添加</button>
                </form>
                <table id="tagsTable" class="table table-hover table-striped" data-toolbar="#tagsToolbar" data-striped="true" data-show-refresh="true" data-show-columns="true" data-search="true" data-pagination="true"></table>
            </div>
        </div>
    </div>
    <div class="row" id="addClassify" style="display: none;">
        <div class="col-md-6">
            <div class="form-group">
                <input type="text" class="form-control" placeholder="添加一个新的分类" />
            </div>
            <div class="form-group">
                <div class="form-control iconInput">
                    <div class="upload-box">
                        <input type="file" tabindex="-1" />
                        <img alt="100%x180" data-src="holder.js/100%x180" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAACK1BMVEUAAAAHH0IIH0QLJEMKJEIMJEQMJEUMJEP/YgD/ZgD/YwAMJUX/YQBzAAD+YAD/XwD/aAD+XwD+YQD8XgD/bgD+YwD+YgD9XgD/eQD/dwD8QwAJIkEJIkEJI0EMJEUMJEQMJEQMJEQMJEQMJEUMJEQMJEQMJEQMJEUMJEQMJEQMJEQMJEUMJEUMJEQMJEQMJEQMJEQMJEQMJEQMJEUMJEQMJEQMJEQMJEQMJEQLJEQOK1ANJ0oOKU4MJEQMJEQMJEQMJUYOLVMMJEQMJEQMJEURNWAMJUUMJEQMJEQMJEUMJEUMJEQMJEQMJEUMJEUMJEQMJEQMJEQMJEUMJUUMJUUMJUUMJUUMJUUMJEQNKEgNJkYNJkUKIkoEHU8MJkYNJkYMJUUMJEQMJEQMJEP/YgD/YwAMJUUMJEQMJEP/YQD/YQAMJET+YQD+YAD+XgD9YwD/YQD/YQD+YgD/YgD/YQD/YQD/YQD/YAD/YgD/YgD/YQD/YQD/YQD/YQD/YAD9XgD+ZAD/YQD/YQD+YAD/YgD/YQD/YAD/YQD/YQD/YQD/YQD+YAD+YwD/YQD/YQD/YQD/YQD/YQD/YQD+YAD/YQD/YQD/YQD+YQD9ZgD/YQD/YQD/YQD/YQD/YQD/YQD+YgD/YQD/YgD+YgD/YgD+YQD/YQD/YgD+YQD/YgD+YgD+YwAMJEQMJEQMJEQMJEQMJEQMJEQMJEQMJEQMJEQMJEQMJEQMJEQMJET///92Of/2AAAAt3RSTlMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAwIknKiiMkr5/mVM+vV2TUtv7s5VmfRJZ+dm++w4AgUDK+GxDAJk6jgBINbZxMXX9svD1Pz9ybO0sbCyLgIFBQUEBQQZz+IiBQoNxiNFb8cQJwEClVQhFRlqtHkoqBVrt3EeAQPHnAtzdAg9lsl8BwPMoUIHpTEGOJd4BwEdZ7NzT5IEuCIBEyqBTigYFwvyOTw6VuT4G4SViycNIRmaAAAAAWJLR0S4Tb8m9gAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAVpJREFUOMtjYBgKgJFJWgYnkGVmYWCVk1fACRSVWBnYlFW2b1eFg+1gAKZBWA2oQF1DU0tZGwp0dPWAwvoGyoZGWsYmptvNQArMLSytrKHAxtYOqMDewdHJ2cXVzR2iQGO7h6cXFHh6gwz28fU03e7h5x8AVRAYFBwCA8GhoaFhoSEh4aHBIZ4qUCtMIyKjYCA6JjYOyoxPSIQqSEpmhwcLR0oqJxeEyZ2WDlOQgVDAk5nFywdTkI2qgI8/Jzcvv6CwqFhAEIsCIeGS0rJykYrKquqa2rp6PnQFHA1ZjU2ZzTwtrTxt7R2dXd186Ap6qnv7+ifkTJzEM3nK1N5p04XQrRCdMXPW7Dlz583nKl1Qu3CRGBZHinMuXrJ0GYfE8hWSfFh9AXSo1MpVonAfY1GACuAKNFabrVmLBaxbvwGswFhlu/lGrEADnGBYN23eghNs3cY60HmGOgAA8YjDYF/F/+0AAAAldEVYdGRhdGU6Y3JlYXRlADIwMTQtMDQtMDNUMjA6MTc6MzYrMDg6MDAMr2/9AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTA0LTAzVDIwOjE3OjM2KzA4OjAwffLXQQAAAE10RVh0c29mdHdhcmUASW1hZ2VNYWdpY2sgNi44LjgtNyBRMTYgeDg2XzY0IDIwMTQtMDItMjggaHR0cDovL3d3dy5pbWFnZW1hZ2ljay5vcmdZpF9/AAAAGHRFWHRUaHVtYjo6RG9jdW1lbnQ6OlBhZ2VzADGn/7svAAAAGHRFWHRUaHVtYjo6SW1hZ2U6OkhlaWdodAAyNTbpw0QZAAAAF3RFWHRUaHVtYjo6SW1hZ2U6OldpZHRoADI1NnoyFEQAAAAZdEVYdFRodW1iOjpNaW1ldHlwZQBpbWFnZS9wbmc/slZOAAAAF3RFWHRUaHVtYjo6TVRpbWUAMTM5NjUyNzQ1NhDAF/sAAAATdEVYdFRodW1iOjpTaXplADYuMTVLQkK7eGe9AAAAYnRFWHRUaHVtYjo6VVJJAGZpbGU6Ly8vaG9tZS9mdHAvMTUyMC9lYXN5aWNvbi5jbi9lYXN5aWNvbi5jbi9jZG4taW1nLmVhc3lpY29uLmNuL3BuZy8xMTQyMC8xMTQyMDAyLnBuZwtMO4wAAAAASUVORK5CYII=" data-holder-rendered="true" />
                    </div>
                    <input class="input-icon" placeholder="Icon文件名称" maxlength="20" />
                </div>
            </div>
            <button type="submit" class="btn btn-info add-btn">添加</button>
        </div>
        <div class="col-md-6">
        </div>
    </div>
    <div class="row" id="editClassify">
        <div class="col-md-6">
            <div class="form-group">
                <input type="text" class="form-control" placeholder="编辑分类" />
            </div>
            <div class="form-group">
                <div class="form-control iconInput">
                    <div class="upload-box">
                        <input type="file" class="hidden-upload" tabindex="-1" />
                        <img alt="100%x180" data-src="holder.js/100%x180" src="data:image/png;base64,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" data-holder-rendered="true" />
                    </div>
                    <input class="input-icon" placeholder="Icon文件名称" maxlength="20" id="uploadIcon" />
                </div>
            </div>
            <div class="content-center">
                <button type="submit" class="btn btn-warning wide-btn">修改</button>
                <button class="btn btn-success wide-btn">还原</button>
                <button class="btn btn-info wide-btn">取消</button>
            </div>
        </div>
        <div class="col-md-6">
        </div>
    </div>
</div>
@section Css{
    <link href="@Url.Content("~/Content/Back/Style/classify.css")" rel="stylesheet" />
    <link href="@Url.Content("~/Content/Back/Plug/bootstrap-table/bootstrap-table.min.css")" rel="stylesheet" />
}
@section FootJs{
    @*<script src="@Url.Content("~/Content/Back/Plug/bootstrap-table/bootstrap-table.js")"></script>*@
    @*<script src="@Url.Content("~/Content/Back/Plug/bootstrap-table/bootstrap-table-zh-CN.js")"></script>*@
    <script type="text/javascript">
        require.config({
            baseUrl: '/Content/Back/JavaScript',
            paths: {
                'so': 'so/so',
                'classify': 'said/classify',
                'bsTable': ['../Plug/bootstrap-table/bootstrap-table'],
                'upload': ['so/plug/upload'],
                'bsTable-cn': ['../Plug/bootstrap-table/bootstrap-table-zh-CN']
            },
            packages: [
            {
                name: 'said',
                location: 'said',
                main: 'said'
            }], shim: {
                'bsTable-cn': ['bsTable']
            }
        });
        require(['so', 'jquery', 'classify', 'upload', 'bsTable-cn'], function (so, $, classify, upload, bsTable) {

            $(function () {
                $('#classifyTable').bootstrapTable({
                    columns: [
                    {
                        field: 'CName',
                        title: '名称',
                        align: 'left',
                        valign: 'bottom',
                        sortable: true
                    },
                    {
                        field: 'CIcon',
                        title: 'Icon文件名',
                        align: 'left',
                        valign: 'bottom',
                        sortable: true
                    },
                    {
                        field: 'ClassifyId',
                        title: '操作',
                        align: 'center',
                        valign: 'bottom',
                        formatter: function (value/*,row,index*/) {
                            return ['<a class="btn btn-info icon-edit data-edit" href="javascript:;" data-id="', value, '" title="编辑"></a><a class="btn btn-danger icon-trash data-delete" href="javascript:;" data="', value, '" title="删除"></a>'].join('');
                        }
                    }],
                    data: [
                        {
                            CName: 'ECMAScript 6',
                            CIcon: 'icon-JS.gif',
                            ClassifyId: '136116aa-a5f6-4f88-bcc4-00a1b4db0dba'
                        },
                        {
                            CName: 'RequireJS',
                            CIcon: 'icon-Require.gif',
                            ClassifyId: '271f2924-69ce-4522-8e39-cc8f31059de8'
                        },
                        {
                            CName: 'JavaScript',
                            CIcon: 'icon-JS.gif',
                            ClassifyId: '2e0dfa2f-dca4-4e1a-abeb-889ce98a8bb0'
                        },
                        {
                            CName: '.NET',
                            CIcon: 'icon-VS.gif',
                            ClassifyId: '6198f526-fa0f-4429-983a-bebc8439e7c8'
                        },
                        {
                            CName: 'CSS',
                            CIcon: 'icon-CSS3.gif',
                            ClassifyId: '817aa0f0-447e-46d3-805c-8952c0332df8'
                        },
                        {
                            CName: 'jQuery',
                            CIcon: 'icon-jQuery.gif',
                            ClassifyId: 'ac11966d-01bf-4554-bd7e-7e0a807ea8fa'
                        },
                        {
                            CName: 'ECMAScript 5',
                            CIcon: 'icon-Web.png',
                            ClassifyId: 'd2774f82-3f56-4b0a-b3ae-0ad203cdc510'
                        }
                    ]

                }).bootstrapTable(
                'append', [{
                    CName: '这是测试Bootstrap append()',
                    CIcon: 'icon-JS.gif',
                    ClassifyId: '136116aa-a5f6-4f88-bcc4-00a1b4db0dba'
                }]//这个api也是醉了
        ).on('dbl-click-row.bs.table', function (e, row, $element) {

        });

                var $tagTable = $('#tagsTable').bootstrapTable({
                    columns: [
                    {
                        field: 'TTagName',
                        title: '名称',
                        align: 'left',
                        sortable: true
                    },
                    {
                        field: 'TTagId',
                        title: '操作',
                        align: 'center',
                        formatter: function (value/*,row,index*/) {
                            return ['<a class="btn btn-info icon-edit data-edit" href="javascript:;" data-id="', value, '" title="编辑"></a><a class="btn btn-danger icon-trash data-delete" href="javascript:;" data="', value, '" title="删除"></a>'].join('');
                            //return ['<a class="btn btn-warning icon-edit data-save" href="javascript:;" data-id="', value, '" title="保存"></a><a class="btn btn-info icon-trash data-cancel" href="javascript:;" data="', value, '" title="取消"></a>'].join('');
                        }
                    }],
                    data: [
                        {
                            TTagName: 'ECMAScript 6',
                            TTagId: '136116aa-a5f6-4f88-bcc4-00a1b4db0dba'
                        },
                        {
                            TTagName: 'RequireJS',
                            TTagId: '271f2924-69ce-4522-8e39-cc8f31059de8'
                        },
                        {
                            TTagName: 'JavaScript',
                            TTagId: '2e0dfa2f-dca4-4e1a-abeb-889ce98a8bb0'
                        },
                        {
                            TTagName: '.NET',
                            TTagId: '6198f526-fa0f-4429-983a-bebc8439e7c8'
                        },
                        {
                            TTagName: 'CSS',
                            TTagId: '817aa0f0-447e-46d3-805c-8952c0332df8'
                        },
                        {
                            TTagName: 'jQuery',
                            TTagId: 'ac11966d-01bf-4554-bd7e-7e0a807ea8fa'
                        },
                        {
                            TTagName: 'ECMAScript 5',
                            TTagId: 'd2774f82-3f56-4b0a-b3ae-0ad203cdc510'
                        }
                    ]

                }).on('dbl-click-row.bs.table', function (e, data, $element) {
                    var $items = $element.children();
                    //不要使用innerHTML，从一个模板中载入一直使用（好像又不能重复使用啊啊啊啊...）
                    $items[0].innerHTML = ['<div class="form-group "><input class="form-control" placeholder="请输入标签" value=', data.TTagName, ' /></div>'].join('');
                    $items[1].innerHTML = ['<a class="btn btn-warning icon-edit data-save" href="javascript:;" data-id="', data.TTagId, '" title="保存"></a><a class="btn btn-info icon-trash data-cancel" href="javascript:;" data="', data.TTagId, '" title="取消"></a>'].join('');
                    //注册各自的事件（不能为空之类、小tip提示之类的）
                    //添加数据的话，则手动操作DOM？？？创建一个
                    /*
                        1、不要把编辑注册到db-click中，应该注册到那个编辑按钮上
                        2、如果要手动操作DOM的话，则要考虑card、列显示、隐藏之类的问题！
                        3、还要考虑上传图片的问题！上传图片得疯狂的封装下了...
                    */
                    console.group();
                    console.log(data);
                    console.groupEnd();
                }).bootstrapTable('updateRow', {
                    index: 2,
                    row: {
                        TTagName: '这是更新的啊啊',
                        TTagId: 'ac11966d-01bf-4554-bd7e-7e0a807ea8fa'
                    }
                });
            });

            //其他逻辑
            var $uploadInput = $('#uploadIcon').uploadText({
                fail: function (error) {
                    $uploadInput.popover({
                        placement: 'top',
                        content: error.msg,
                        title: '上传异常',
                        trigger: 'focus'
                    }).popover('show');
                    $window.one('click', function () {
                        $uploadInput.popover('destroy');
                    });
                }
            }), $window = $(window);
        });
    </script>
}
